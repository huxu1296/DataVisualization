(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cf822daa"],{"31d9":function(t,e,a){"use strict";a.r(e);a("6d95"),a("6823");var o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"salary-box"},[e("div",{staticClass:"job-filter"},[e("div",{staticClass:"filter-group"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedJob,expression:"selectedJob"}],staticClass:"filter-select",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selectedJob=e.target.multiple?a:a[0]}}},[e("option",{attrs:{value:""}},[t._v("选择职位")]),t._l(t.availableJobs,(function(a,o){return e("option",{key:o,domProps:{value:a.title}},[t._v(" "+t._s(t.truncateText(a.title,12))+" ")])}))],2)]),e("button",{staticClass:"filter-button",on:{click:t.updateChart}},[t._v("更新")])]),e("div",{ref:"chartContainer",staticClass:"chart-container"})])},r=[],i=(a("25c1"),a("378e"),a("ada4")),s={name:"SalaryBox",props:{data:{type:Object,default:()=>({})}},data(){return{myChart:null,selectedJob:"",availableJobs:[],currentJobTitles:[],currentBoxplotData:[]}},methods:{truncateText(t,e){return t?t.length>e?t.substring(0,e):t:""},updateChart(){if(!this.selectedJob)return;const t=this.data&&this.data.jobProfiles?this.data.jobProfiles:[],e=t.find(t=>t.title===this.selectedJob);if(e){console.log("选择的职位数据:",e);const t=this.calculateBoxplotData(e.salaries),a=this.currentJobTitles.findIndex(t=>t===this.selectedJob);if(-1!==a){const e=[...this.currentBoxplotData];e[a]=t,this.currentBoxplotData=e}else this.currentJobTitles=[...this.currentJobTitles,this.selectedJob],this.currentBoxplotData=[...this.currentBoxplotData,t];this.renderChart()}},calculateBoxplotData(t){if(!t||!t.length)return console.log("没有薪资数据"),[0,0,0,0,0];console.log("原始薪资数据:",t);const e=[];for(const n of t){const t=String(n);let a=t.match(/(\d+)(?:k|K)?(?:\s*[-~]\s*)(\d+)(?:k|K)?/i);if(a){const t=parseInt(a[1]),o=parseInt(a[2]),r=(t+o)/2;e.push(r)}else if(a=t.match(/^(\d+)(?:k|K)$/i),a){const t=parseInt(a[1]);e.push(t)}else if(a=t.match(/^(\d+)$/),a){const t=parseInt(a[1]);e.push(t)}}if(console.log("解析后的薪资值:",e),0===e.length)return console.log("没有有效的薪资值"),[0,0,0,0,0];e.sort((t,e)=>t-e);const a=e[0],o=e[e.length-1];let r,i,s;if(1===e.length)r=i=s=a;else{const t=Math.floor(.25*e.length),a=Math.floor(.5*e.length),o=Math.floor(.75*e.length);r=e[t],i=e[a],s=e[o]}const l=[a,r,i,s,o];return console.log("计算的箱线图数据:",l),l},initializeChart(){console.log("初始化箱线图");let t=[],e=[];const a=this.data&&this.data.jobProfiles?this.data.jobProfiles:[];if(a.length>0){console.log("找到职位数据:",a.length,"条");const o=[...a].sort((t,e)=>e.count-t.count).slice(0,5);t=o.map(t=>t.title),e=o.map(t=>this.calculateBoxplotData(t.salaries)),this.currentJobTitles=t,this.currentBoxplotData=e,this.availableJobs=a.map(t=>({title:t.title})),console.log("初始化图表数据:",{jobs:t,data:e})}else console.warn("未找到职位数据, 使用备用数据"),t=["前端开发","后端开发","产品经理","UI设计师","数据分析师"],e=[[3,5,8,12,15],[5,8,12,15,20],[8,12,15,20,25],[5,8,10,15,18],[4,7,10,14,18]],this.currentJobTitles=t,this.currentBoxplotData=e;!this.myChart&&this.$refs.chartContainer&&(this.myChart=i["init"](this.$refs.chartContainer)),this.renderChart()},renderChart(){if(!this.myChart)return;if(0===this.currentJobTitles.length||0===this.currentBoxplotData.length)return void console.warn("没有数据可以渲染");const t=this.currentJobTitles.map(t=>this.truncateText(t,5)),e=["#2ca8fe","#a262f2","#feed2c","#c0232a","#fe672c","#40798c"],a={title:{text:"职位薪资对比分析",textStyle:{color:"#75deef",fontSize:14},left:"center",top:10},tooltip:{trigger:"item",backgroundColor:"#11367a",textStyle:{color:"#6dd0e3"},formatter:t=>{if(0===t.seriesIndex){const e=t.value,a=this.currentJobTitles[t.dataIndex]||t.name;return[a+" 薪资统计 (K):","最大值: "+e[4],"上四分位: "+e[3],"中位数: "+e[2],"下四分位: "+e[1],"最小值: "+e[0]].join("<br/>")}return t.name+": "+t.value+"K"},axisPointer:{type:"shadow"}},grid:{left:"10%",right:"10%",top:"15%",bottom:"15%"},xAxis:{type:"category",data:t,boundaryGap:!0,nameGap:30,splitArea:{show:!1},axisLine:{lineStyle:{color:"#1a3c58"}},axisLabel:{color:"#75deef",fontSize:12,rotate:30,interval:0},splitLine:{show:!1}},yAxis:{type:"value",name:"薪资 (K/月)",min:0,nameTextStyle:{color:"#75deef",fontSize:12},axisLabel:{formatter:"{value}K",color:"#75deef"},axisLine:{lineStyle:{color:"#1a3c58"}},splitLine:{lineStyle:{color:"rgba(26,60,88,0.3)"}}},series:[{name:"职位薪资分布",type:"boxplot",data:this.currentBoxplotData,tooltip:{formatter:t=>{const e=this.currentJobTitles[t.dataIndex]||t.name;return[e+" 薪资统计 (K):","最大值: "+t.data[4],"上四分位: "+t.data[3],"中位数: "+t.data[2],"下四分位: "+t.data[1],"最小值: "+t.data[0]].join("<br/>")}},itemStyle:{color:function(t){return e[t.dataIndex%e.length]},borderColor:function(t){return e[t.dataIndex%e.length]}},emphasis:{itemStyle:{borderWidth:2,shadowBlur:10,shadowColor:"rgba(44, 168, 254, 0.5)"}}},{name:"中位数薪资",type:"scatter",symbolSize:8,data:this.currentBoxplotData.map((t,e)=>[e,t[2]]),itemStyle:{color:"#feed2c",borderColor:"#fff",borderWidth:1},label:{show:!0,position:"top",formatter:"{c}K",color:"#feed2c",fontSize:10}}]};this.myChart.setOption(a),this.myChart.resize()},setChart(){this.initializeChart()}},watch:{"data.jobProfiles":{handler(t){console.log("职位数据更新，重新初始化图表"),this.initializeChart()},immediate:!0}},mounted(){this.$nextTick(()=>{this.initializeChart()}),this.handleResize=()=>{this.myChart&&this.myChart.resize()},window.addEventListener("resize",this.handleResize)},beforeDestroy(){window.removeEventListener("resize",this.handleResize),this.myChart&&(this.myChart.dispose(),this.myChart=null)}},l=s,n=(a("423c"),a("1805")),c=Object(n["a"])(l,o,r,!1,null,"1043cf4d",null);e["default"]=c.exports},"423c":function(t,e,a){"use strict";a("6108")},6108:function(t,e,a){}}]);
//# sourceMappingURL=chunk-cf822daa.d936b5e8.js.map